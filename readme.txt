================================================================================
  ApprovalNotifier.exe — 承認通知デスクトップ常駐アプリ
================================================================================

■ 概要
────────────────────────────────────────────────────────

このアプリは、社内承認システムと連携し、「承認待ちの申請がある場合に
デスクトップ上で即座に通知する」ことを目的とした常駐型通知アプリです。

役員や管理職が出張・外出中でもリアルタイムに承認状況を把握できるように
設計されており、画面右下に常時表示される「承認待ちバッジ」＋
「タスクトレイ常駐アイコン」で動作します。


■ 主な機能
────────────────────────────────────────────────────────

  🔄 定期チェック
     指定間隔でAPIをポーリングし、承認待ち件数を取得

  🔔 ダイアログ通知
     初回起動時、または新規承認発生時にポップアップでお知らせ

  🎯 右下バッジ
     デスクトップ右下に常時表示される円形バッジ
     危険・警告を色で可視化

  🖱️ 操作性
     ・ドラッグで位置変更
     ・Ctrl + マウスホイールでサイズ調整可能
     ・ダブルクリックで承認ページを開く

  ⚙️ 設定保存
     位置・サイズ・ユーザーIDなどを
     approval-notify-setting.json に自動保存

  🧑‍💼 管理者GUI
     管理者パスワード（Akioka55）入力でGUI設定変更が可能

  🪟 タスクトレイ操作
     起動／終了／再起動をタスクトレイメニューから制御可能

  🖼️ カスタムアイコン
     icon.png をタスクトレイアイコンとして使用可能


■ 動作イメージ
────────────────────────────────────────────────────────

【通常時（右下バッジ）】

  • 灰色     → 承認待ちなし
  • オレンジ → 期限が迫っている申請あり
  • 赤       → 緊急承認案件あり

  バッジ上には「承認待ち 〇件」と表示されます。
  クリック・ドラッグ・ダブルクリックが可能です。


【ダブルクリック】

  承認画面を自動で開きます：
  https://akioka.cloud/accept/order-request?user_id=2


■ 設定ファイル：approval-notify-setting.json
────────────────────────────────────────────────────────

アプリ起動時に同階層にこのファイルを参照します。
存在しない場合は自動生成されます。

【設定例】

  {
    "user_id": 2,
    "x": 1750,
    "y": 940,
    "size": 100,
    "refresh_interval": 60
  }


【パラメータ説明】

  user_id            : 承認者のID（APIに送信される）
  x, y               : バッジ表示位置（画面左上基準の座標）
  size               : バッジのサイズ（最小80〜最大300）
  refresh_interval   : APIリクエスト間隔（秒）


■ API仕様
────────────────────────────────────────────────────────

【リクエスト】

  URL        : https://akioka.cloud/api/order_request/approval_requests
  パラメータ : user_id（例: 2）
  形式       : GET リクエスト


【レスポンス（JSON形式）】

  {
    "order_requests_count": 14,
    "danger_count": 8,
    "alert_count": 0
  }

  order_requests_count : 承認待ちの合計件数
  danger_count         : 至急承認が必要な件数
  alert_count          : 期限が迫っている件数


■ ファイル構成
────────────────────────────────────────────────────────

  approval-notify/
  ├── ApprovalNotifier.exe              ← 実行ファイル
  ├── approval-notify-setting.json      ← 設定ファイル（自動生成）
  └── icon.png                          ← トレイ／ウィンドウアイコン


■ EXEビルド手順
────────────────────────────────────────────────────────

【1. 依存ライブラリをインストール】

  pip install pyinstaller pillow requests pystray


【2. EXEビルド】

  pyinstaller --onefile --noconsole --icon=icon.png main3.py


【3. 生成結果】

  dist/ApprovalNotifier.exe


■ 自動起動（スタートアップ登録）
────────────────────────────────────────────────────────

  1. Win + R で「ファイル名を指定して実行」を開く

  2. 「shell:startup」と入力して実行

  3. 開いたフォルダに ApprovalNotifier.exe のショートカットをコピー

  → Windows起動時に自動で承認通知アプリが起動します。


■ 管理者モード
────────────────────────────────────────────────────────

タスクトレイメニュー → 「管理者モード」選択時、
パスワード「Akioka55」を入力するとGUIで以下を変更可能：

  • user_id
  • 表示位置・サイズ
  • 更新間隔（秒）
  • 設定の保存／再読込


■ 通知タイミング
────────────────────────────────────────────────────────

  初回起動時       : 「現在の承認待ち件数」をダイアログ表示
  新規承認発生時   : 「未承認申請があります」ダイアログ表示
  通常監視中       : バッジ色・件数のみ更新（静音更新）


■ UIの特徴
────────────────────────────────────────────────────────

  • 丸型バッジデザイン（ソフトシャドウ付き）
  • 透明背景で自然にデスクトップに馴染む
  • モダンなマテリアルデザイン配色
  • Segoe UI / Yu Gothic UI フォントで美しい表示
  • Windowsのテーマに依存しない独立UI


■ 開発環境
────────────────────────────────────────────────────────

  言語            : Python 3.10〜3.13 対応
  GUIライブラリ   : Tkinter
  補助ライブラリ  : requests, pystray, Pillow, threading, json
  実行環境        : Windows 10 / 11 対応


■ トラブルシューティング
────────────────────────────────────────────────────────

  【JSONが見つからない】
    → 自動生成されるので再起動してください

  【アイコンが表示されない】
    → icon.png をEXEと同じフォルダに配置してください

  【黒いコンソールが出る】
    → ビルド時に --noconsole を指定してください

  【起動しても反応がない】
    → ファイアウォール設定で akioka.cloud への通信を許可してください

  【バッジが文字化けする】
    → Ctrl + マウスホイールでサイズを調整してください


■ ライセンス・著作権
────────────────────────────────────────────────────────

本アプリは社内利用を目的として開発されたものであり、
ソースコード・実行ファイルの再配布・商用利用は禁止とします。

著作権は株式会社〇〇〇〇（例：Akioka Foundry）に帰属します。


■ 開発担当
────────────────────────────────────────────────────────

  DX推進室／社内SE担当
  村上 飛羽（Akioka Foundry）


================================================================================
